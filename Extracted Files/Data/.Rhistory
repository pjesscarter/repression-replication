#Load packages for data exploration
if(!require(pacman)){
install.packages("pacman")
library(pacman)
}
p_load(haven,stringr,dplyr,ggplot2,sf)
setwd("../../Extracted Files/Data")
toload <- str_subset(list.files(),".dta")
data <- lapply(toload, read_dta)
shp <- read_sf("Map/cl_comunas_geo/Paper Replication/Data/Map/cl_comunas_geo.shp")
fnl <- data[[1]]
fnl <- fnl %>% mutate(dist = exp(LnDistMilitaryBase),
cutoff5 = as.numeric(dist<5),
cutoff10 = as.numeric(dist<10)
)
max(fnl$dist)
max(fnl$dist,na.rm=TRUE)
fnl <- fnl %>% filter(MainSample) %>% mutate(dist = exp(LnDistMilitaryBase),
cutoff5 = as.numeric(dist<5),
cutoff10 = as.numeric(dist<10)
)
fnl <- fnl %>% filter(MainSample==1) %>% mutate(dist = exp(LnDistMilitaryBase),
cutoff5 = as.numeric(dist<5),
cutoff10 = as.numeric(dist<10)
)
max(fnl$dist)
max(fnl$dist[fnl$DMilitaryPresence==1])
min(fnl$dist[fnl$DMilitaryPresence==1])
fnl$dist[fnl$DMilitaryPresence==1]
fnl$dist
quantile(fnl$dist[fnl$DMilitaryPresence==1])
quantile(fnl$dist[fnl$DMilitaryPresence==0])
fnl <- data[[1]]
View(fnl)
fnl <- fnl %>% filter(!is.na(IDProv)) %>% mutate(dist = exp(LnDistMilitaryBase),
cutoff5 = as.numeric(dist<5),
cutoff10 = as.numeric(dist<10)
)
controls <- ("share_allende70",
"share_alessandri70",
"lnDistStgo",
"lnDistRegCapital",
"Pop70_pthousands",
"sh_rural_70")
controls <- c("share_allende70",
"share_alessandri70",
"lnDistStgo",
"lnDistRegCapital",
"Pop70_pthousands",
"sh_rural_70")
makeform <- function(treat,outcome){
#Edit to change baseline controls
controls <- c("share_allende70",
"share_alessandri70",
"lnDistStgo",
"lnDistRegCapital",
"Pop70_pthousands",
"sh_rural_70")
f <- as.formula(
paste(outcome,
paste(c(treat,controls), collapse = " + "),
sep = " ~ "))
}
?lm
#Victimization results, robustness to binary linear regression
makeform("cutoff10","shVictims_70")
#Victimization results, robustness to binary linear regression
print(makeform("cutoff10","shVictims_70"))
#Edit to change baseline controls
controls <- c("share_allende70",
"share_alessandri70",
"lnDistStgo",
"lnDistRegCapital",
"Pop70_pthousands",
"sh_rural_70",
"IDProv")
makeform <- function(treat,outcome){
#Edit to change baseline controls
controls <- c("share_allende70",
"share_alessandri70",
"lnDistStgo",
"lnDistRegCapital",
"Pop70_pthousands",
"sh_rural_70",
"IDProv")
f <- as.formula(
paste(outcome,
paste(c(treat,controls), collapse = " + "),
sep = " ~ "))
}
#Victimization results, robustness to binary linear regression
summary(lm(makeform("cutoff10","shVictims_70"),data=fnl,weights=Pop70))
#Victimization results, robustness to binary linear regression
summary(lm(makeform("cutoff5","shVictims_70"),data=fnl,weights=Pop70))
#Victimization results, robustness to binary linear regression
summary(lm(makeform("cutoff20","shVictims_70"),data=fnl,weights=Pop70))
fnl <- fnl %>% filter(!is.na(IDProv)) %>% mutate(dist = exp(LnDistMilitaryBase),
cutoff5 = as.numeric(dist<5),
cutoff10 = as.numeric(dist<10),
cutoff20 = as.numeric(dist<20),
IDProv = as.factor(IDProv)
)
makeform <- function(treat,outcome){
#Edit to change baseline controls
controls <- c("share_allende70",
"share_alessandri70",
"lnDistStgo",
"lnDistRegCapital",
"Pop70_pthousands",
"sh_rural_70",
"IDProv")
f <- as.formula(
paste(outcome,
paste(c(treat,controls), collapse = " + "),
sep = " ~ "))
}
#Victimization results, robustness to binary linear regression
summary(lm(makeform("cutoff20","shVictims_70"),data=fnl,weights=Pop70))
#Victimization results, robustness to binary linear regression
summary(lm(makeform("cutoff5","shVictims_70"),data=fnl,weights=Pop70))
#Victimization results, robustness to binary linear regression
summary(lm(makeform("DMilitaryPresence","shVictims_70"),data=fnl,weights=Pop70))
#Victimization results, robustness to binary linear regression
summary(lm(makeform("LnDistMilitaryBase","shVictims_70"),data=fnl,weights=Pop70))
quantile(fnl$dist[fnl$DMilitaryPresence!=1])
fnl <- fnl %>% filter(!is.na(IDProv)) %>% mutate(dist = exp(LnDistMilitaryBase),
cutoff2 = as.numeric(dist<2),
cutoff5 = as.numeric(dist<5),
cutoff10 = as.numeric(dist<10),
cutoff20 = as.numeric(dist<20),
IDProv = as.factor(IDProv)
)
#Victimization results, robustness to binary linear regression
summary(lm(makeform("cutoff2","shVictims_70"),data=fnl,weights=Pop70))
fnl <- fnl %>% filter(!is.na(IDProv)) %>% mutate(dist = exp(LnDistMilitaryBase),
cutoff3 = as.numeric(dist<2),
cutoff5 = as.numeric(dist<5),
cutoff10 = as.numeric(dist<10),
cutoff20 = as.numeric(dist<20),
IDProv = as.factor(IDProv)
)
#Victimization results, robustness to binary linear regression
summary(lm(makeform("cutoff2","shVictims_70"),data=fnl,weights=Pop70))
#Victimization results, robustness to binary linear regression
summary(lm(makeform("cutoff3","shVictims_70"),data=fnl,weights=Pop70))
fnl <- fnl %>% filter(!is.na(IDProv)) %>% mutate(dist = exp(LnDistMilitaryBase),
cutoff3 = as.numeric(dist<2),
cutoff4 = as.numeric(dist<2),
cutoff5 = as.numeric(dist<5),
cutoff10 = as.numeric(dist<10),
cutoff20 = as.numeric(dist<20),
IDProv = as.factor(IDProv)
)
#Victimization results, robustness to binary linear regression
summary(lm(makeform("cutoff4","shVictims_70"),data=fnl,weights=Pop70))
#Victimization results, robustness to binary linear regression
summary(lm(makeform("cutoff5","shVictims_70"),data=fnl,weights=Pop70))
fnl <- fnl %>% filter(!is.na(IDProv)) %>% mutate(dist = exp(LnDistMilitaryBase),
cutoff3 = as.numeric(dist<3),
cutoff4 = as.numeric(dist<4),
cutoff5 = as.numeric(dist<5),
cutoff10 = as.numeric(dist<10),
cutoff20 = as.numeric(dist<20),
IDProv = as.factor(IDProv)
)
summary(lm(makeform("cutoff4","shVictims_70"),data=fnl,weights=Pop70))
summary(lm(makeform("cutoff3","shVictims_70"),data=fnl,weights=Pop70))
paste("cutoff",1,sep="")
#Victimization results, robustness to binary linear regression
#main result holds for cutoffs <5 miles
models<-list()
for(i in c(3:5,10,20)){
models<-c(models,summary(lm(makeform(paste(cutoff,i,sep=""),"shVictims_70"),data=fnl,weights=Pop70)))
}
#Victimization results, robustness to binary linear regression
#main result holds for cutoffs <5 miles
models<-list()
for(i in c(3:5,10,20)){
models<-c(models,summary(lm(makeform(paste("cutoff",i,sep=""),"shVictims_70"),data=fnl,weights=Pop70)))
}
#Victimization results, robustness to binary linear regression
#main result holds for cutoffs <5 miles
models<-list()
for(i in c(3:5,10,20)){
models<-c(models,lm(makeform(paste("cutoff",i,sep=""),"shVictims_70"),data=fnl,weights=Pop70))
}
#Victimization results, robustness to binary linear regression
#main result holds for cutoffs <5 miles
models<-list()
for(i in c(3:5,10,20)){
models<-c(models,lm(makeform(paste("cutoff",i,sep=""),"shVictims_70"),data=fnl,weights=Pop70))
}
#Victimization results, robustness to binary linear regression
#main result holds for cutoffs <5 miles
models<-list()
cutoffs <- c(3:5,10,20)
for(i in seq_along(cutoffs)){
models[[i]]<-c(models,lm(makeform(paste("cutoff",i,sep=""),"shVictims_70"),data=fnl,weights=Pop70))
}
for(i in seq_along(cutoffs)){
models[[i]]<-c(models,lm(makeform(paste("cutoff",cutoffs[i],sep=""),"shVictims_70"),data=fnl,weights=Pop70))
}
library(stargazer)
paste0(cutoffs, " miles")
paste0("cutoff",cutoffs)
stargazer(models,
style="apsr",paste0(cutoffs, " Miles"),
keep=paste0("cutoff",cutoffs),
covariate.labels = c("Treatment Indicator"),
dep.var.labels = c("Victimization"),
keep.stat = c("n"))
stargazer(models)
#Victimization results, robustness to binary linear regression
#main result holds for cutoffs <5 miles
models<-list()
cutoffs <- c(3:5,10,20)
for(i in seq_along(cutoffs)){
models[[i]]<-c(models,lm(makeform(paste("cutoff",cutoffs[i],sep=""),"shVictims_70"),data=fnl,weights=Pop70))
}
stargazer(models,
style="apsr",paste0(cutoffs, " Miles"),
keep=paste0("cutoff",cutoffs),
covariate.labels = c("Treatment Indicator"),
dep.var.labels = c("Victimization"),
keep.stat = c("n"))
summary(models[[1]])
summary(models[[2]])
summary(models[[3]])
length(models)
#Victimization results, robustness to binary linear regression
#main result holds for cutoffs <5 miles
models<-list()
cutoffs <- c(3:5,10,20)
for(i in seq_along(cutoffs)){
models[[i]]<-lm(makeform(paste("cutoff",cutoffs[i],sep=""),"shVictims_70"),data=fnl,weights=Pop70)
}
stargazer(models,
style="apsr",paste0(cutoffs, " Miles"),
keep=paste0("cutoff",cutoffs),
covariate.labels = c("Treatment Indicator"),
dep.var.labels = c("Victimization"),
keep.stat = c("n"))
